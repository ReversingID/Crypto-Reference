/*
	Hash function by Daniel J. Bernstein
    Archive of Reversing.ID
    Non-Cryptographic Hash

    Assemble:
        (gcc)
        $ gcc -m32 -S -masm=intel -o DJBHash.asm DJBHash.c

        (msvc)
        $ cl /c /FaDJBHash.asm DJBHash.c
*/
#include <stdint.h>

uint32_t T0 [] = {
    4143812366l, 2806512183l, 4212398656l,  393834663l,
    3943187971l,  847901099l, 3746904015l, 2990585247l,
    4243977488l, 4075301976l, 2737181671l, 2429701352l,
    4196558752l, 3152011060l, 1432515895l,  204108242l,
    1180540305l,  922583281l, 1734842702l, 1453807349l,
     507756934l, 1553886700l, 2005976083l, 3346025117l,
      97642817l, 2510760451l, 4103916440l, 3222467334l,
    1312447049l,  522841194l, 3955607179l, 3028936967l,
    2763655970l, 3033075496l, 1935362065l,  512912210l,
    2660383701l, 1652921526l,  260485165l,  141882627l,
    2895806269l,  804034013l, 1356707616l, 3942447612l,
    2875374199l,   81028672l, 1055595160l, 2755907176l,
    2880512448l, 1232977841l, 3719796487l, 2940441976l,
    3739585976l,  168332576l, 1318372270l, 3173546601l,
    3992298512l, 3785690335l, 3667530757l, 3101895251l,
    2789438017l, 3213463724l, 3067100319l, 2554433152l,
     794184286l, 2599814956l, 1251486151l, 4214997752l,
     690900134l,  323888098l, 1537487787l, 1155362310l,
    1826165850l, 2358083425l, 2957662097l, 2514517438l,
    1828367703l, 3847031274l, 2308450901l,  955547506l,
    1037823031l, 2922505570l, 2544914051l, 2572931499l,
     442837508l, 1873354958l, 2004376537l,   25413657l,
    3560636876l, 1768043132l, 2870782748l, 1031556958l,
     715180405l,  201079975l, 4116730284l, 2748714587l,
    1091411202l,   33354499l, 1931487277l, 1039106939l,
    3327011403l,  396608379l, 3447523131l,  301432924l,
    3180185526l, 1780290520l, 3909968679l, 2398211959l,
    3704875308l,   66082280l,  601805180l, 3226323057l,
    3284786200l, 2282257088l,  700775591l, 3528928994l,
    1601645543l,  120115228l,  568698020l,  178214456l,
      41846783l,  897656032l, 3309570546l, 2624714322l,
    2542948622l, 1168171675l, 2460933760l,   93808223l,
    2384991231l, 4268721795l, 4001720080l, 1516739672l,
    4111847489l,  810915309l, 1238071781l,  935043360l,
    2020231594l,   37717498l, 3603218947l, 1534593867l,
    2819275526l, 1965883441l,  674162751l,  128087286l,
    4138356188l,  543626850l, 1355906380l, 3565721429l,
    1142978716l, 1614752605l, 1624389156l, 3363454971l,
    2029311310l, 2249603714l, 3448236784l, 1764058505l,
    2198836711l, 3481576182l, 3168665556l, 3834682664l,
    1979945243l, 3456525349l, 2721891322l, 1099639387l,
    1528675965l, 3069012165l, 1807951214l, 1901014398l,
    2805656341l, 3321210152l, 2317543573l, 1015607418l,
     178584554l, 4020226276l,  492648819l,   97778844l,
    4134244261l, 1389599433l,  331211243l, 3769684011l,
    2036127367l, 3174548433l, 3241354897l, 2570869934l,
    3071842004l, 1972073698l,   48467379l, 1015444026l,
    3126762609l, 1104264591l, 3096375666l, 1380392409l,
     684368280l, 1493310388l, 2109527660l, 3034364089l,
    3168522906l, 3042350939l, 3696929834l, 3410250713l,
    3726870750l, 3357455860l, 1816295563l, 2678332086l,
      26178399l,  614899533l, 2248041911l, 1431155883l,
    1184971826l, 3711847923l, 2744489682l,  168580352l,
     694400736l, 2659092308l,  811197288l, 1093111228l,
     824677015l, 2041709752l, 1650020171l, 2344240270l,
    3773698958l, 3393428365l, 3498636527l,  556541408l,
    1883820721l, 3249806350l, 3635420446l, 1661145756l,
    3087642385l, 1620143845l, 3852949019l, 1054565053l,
    3574021829l, 2466085457l, 2078148836l,  460565767l,
    4097474724l, 1381665351l, 1652238922l, 2200252397l,
    3726797486l, 4001080204l,  259576503l,  567653141l,
     325219513l, 1227314237l, 3191441965l, 1433728871l,
    4198425173l, 2908977223l, 3757065246l,  294312130l,
    4136006097l, 3409363054l, 2112383431l, 1177366649l
};

uint32_t T1 [] = {
     826524031l,  360568984l, 3001046685l, 1511935255l,
    1287825396l, 3167385669l, 1488463483l, 4077470910l,
    1360843071l,  986771770l, 2307292828l, 3845679814l,
    1429883439l, 1990257475l, 4087625806l, 1700033651l,
    1388994450l,  935547107l, 3237786789l,  644530675l,
    2274037095l,  888755779l, 3020158166l, 2136355264l,
    2558959443l, 1751931693l, 2325730565l, 3029134627l,
     668542860l, 2140243729l, 2384660990l,  666440934l,
     842610975l, 1563602260l, 1429103271l,  899918690l,
    3441536151l, 4078621296l, 1527765522l, 4191433361l,
     222526771l,  309447417l, 2035245353l, 3730203536l,
    3330019758l,  876252573l, 2545027471l,  453932528l,
     282738293l, 1826993794l, 1569532013l,  543681326l,
    3097574376l, 2336551794l, 1563241416l, 1127019882l,
    3088670038l, 2766122176l, 3706267663l, 1110947226l,
    2608363541l, 3166834418l, 1310161541l,  755904436l,
    2922000163l, 3815555181l, 1578365408l, 3137960721l,
    3254556244l, 4287631844l,  750375141l, 1481489491l,
    1903967768l, 3684774106l,  765971482l, 3225162750l,
    2946561128l, 1920278401l, 1803486497l, 4166913456l,
    1855615192l, 1934651772l, 1736560291l, 2101779280l,
    3560837687l, 3004438879l,  804667617l, 2969326308l,
    3118017313l, 3090405800l,  566615197l, 2451279063l,
    4029572038l, 2612593078l, 3831703462l,  914594646l,
    2873305199l, 2860901605l, 3296630085l, 1273702937l,
    2852911938l, 1003268745l, 1387783190l,  159227777l,
    2211994285l,   28095103l, 3659848176l, 3976935977l,
    3301276082l, 2641346573l,  651238838l, 2264520966l,
    1484747269l, 3016251036l, 3857206301l,   91952846l,
    1662449304l, 2028491746l, 1613452911l, 2409055848l,
    1453868667l, 4146146473l, 1646176015l, 3769580099l,
    3171524988l, 2980516679l, 828895558l, 3384493282l
};

uint32_t GoulburnHash(const char* key, uint32_t length)
{
    uint32_t state = 0;
    uint32_t i = 0;

    for (i = 0; i < length; ++key, i++)
    {
        state += T0 [key[i]];
        state ^= (state << 3) ^ (state >> 29);
        state += T1 [state >> 25];
        state ^= (state << 14) ^ (state >> 18);
        state += 1783936964;
    }
    return state;
}